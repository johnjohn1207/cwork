<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>量化回測儀表板</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(fetchAndDraw);

        async function fetchAndDraw() {
            try {
                // 1. 使用 Fetch API 讀取 C++ 產出的 data.json
                const response = await fetch('data.json');
                const rawData = await response.json();
                
                // 2. 整理成 Google Charts 需要的陣列格式
                const chartData = [['Date', 'Price']];
                rawData.forEach(item => {
                    chartData.push([item.date, item.price]);
                });
                
                // 3. 繪圖
                const dataTable = google.visualization.arrayToDataTable(chartData);
                const options = {
                    title: '回測淨值曲線 (Equity Curve)',
                    curveType: 'function',
                    legend: { position: 'bottom' }
                };
                const chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(dataTable, options);
            } catch (err) {
                console.error("無法讀取 JSON 數據：", err);
            }
        }
    </script>
</head>
<body>
    <h1>策略回測結果展示</h1>
    <div id="chart_div" style="width: 100%; height: 500px;"></div>
</body>
</html>